<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Márkaszemélyiség kvíz</title>

<link rel="stylesheet" href="https://use.typekit.net/bja6xtr.css">

<style>
  * { box-sizing: border-box; }

  body { 
    font-family: "atyp-bl-variable", sans-serif;
    font-variation-settings: "opsz" 6, "ital" 0, "wght" 280;
    margin:0; 
    padding:16px; 
    background:#242427; 
  }

  .quiz { 
    max-width:520px; 
    margin:auto; 
    background:#fff; 
    padding:28px 24px 24px; 
    border-radius:18px; 
    box-shadow:0 18px 45px rgba(0,0,0,0.25);
  }

  h1 { 
    text-align:center; 
    font-size:26px; 
    margin-bottom:24px; 
    letter-spacing:0.03em;
  }

  h2 { 
    font-size:20px; 
    margin-bottom:16px; 
  }

  p {
    font-size:15px;
    line-height:1.5;
    margin-bottom:16px;
  }

  .step { display:none; }
  .step.active { display:block; }

  .options { 
    display:grid; 
    gap:16px; 
    grid-template-columns:1fr; 
  }

  .option { 
    border:2px solid #e3e3e3; 
    border-radius:16px; 
    overflow:hidden; 
    cursor:pointer; 
    transition:transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
    background:#fafafa; 
  }

  .option img { 
    width:100%; 
    height:220px; 
    object-fit:cover; 
    display:block; 
  }

  .option.selected { 
    border-color:#111; 
    box-shadow:0 0 0 2px #111; 
    transform:translateY(-2px); 
  }

  button { 
    width:100%; 
    margin-top:24px; 
    padding:14px; 
    font-size:16px; 
    border:none; 
    border-radius:999px; 
    background:#111; 
    color:white; 
    cursor:pointer;
    transition:background 0.15s ease, transform 0.1s ease, box-shadow 0.1s ease;
  }

  button:hover:not(:disabled) { 
    background:#000; 
    box-shadow:0 8px 20px rgba(0,0,0,0.22);
    transform:translateY(-1px);
  }

  button:active:not(:disabled) {
    transform:translateY(0);
    box-shadow:none;
  }

  button:disabled {
    opacity:0.7;
    cursor:default;
    box-shadow:none;
  }

  .result ul { 
    list-style:none; 
    padding:0; 
    margin:0;
  }

  .result li { 
    padding:6px 0; 
    font-size:16px; 
    display:flex;
    justify-content:space-between;
  }

  .result li strong {
    font-weight:600;
  }

  input { 
    width:100%; 
    padding:14px; 
    margin-bottom:12px; 
    font-size:15px; 
    border-radius:10px; 
    border:1px solid #ccc; 
  }

  .send-status {
    margin-top:8px;
    font-size:14px;
    color:#555;
    text-align:center;
    min-height:20px;
  }

  .spinner {
    display:inline-block;
    width:14px;
    height:14px;
    border:2px solid rgba(0,0,0,0.15);
    border-top-color:#000;
    border-radius:50%;
    animation:spin 0.7s linear infinite;
    vertical-align:middle;
    margin-right:6px;
  }

  @keyframes spin {
    to { transform:rotate(360deg); }
  }
</style>
</head>
<body>
<div class="quiz">
  <h1>Márkaszemélyiség kvíz</h1>
  <div id="steps"></div>
</div>

<script>
const archetypes = { Mars:0, Jupiter:0, Apollo:0, Ceres:0, Juno:0, Venus:0, Hera:0, Mercury:0 };
const stepsEl = document.getElementById("steps");

stepsEl.innerHTML += `
<div class="step active">
  <h2>Üdvözlünk a Márkaszemélyiség kvízben!</h2>
  <p>Ez a kvíz segít feltérképezni, milyen archetípus jellemzi a céget. Kérjük, add meg az email címed, hogy az eredményeket el tudjuk küldeni.</p>
  <input type="email" placeholder="Email címed" id="startEmail">
  <input type="text" placeholder="Név" id="startName">
  <button onclick="startQuiz()">Kezdhetjük</button>
</div>
`;

const stepsData = [
  { q:"Vendégváró tér", type:"image", options:["https://picsum.photos/600/400?random=1","https://picsum.photos/600/400?random=2","https://picsum.photos/600/400?random=3","https://picsum.photos/600/400?random=4","https://picsum.photos/600/400?random=5","https://picsum.photos/600/400?random=6","https://picsum.photos/600/400?random=7","https://picsum.photos/600/400?random=8"], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Venus","Hera","Mercury"] },
  { q:"Tárgyaló", type:"image", options:["https://picsum.photos/600/400?random=9","https://picsum.photos/600/400?random=10","https://picsum.photos/600/400?random=11"], archetypes:["Mars","Jupiter","Apollo"] },
  { q:"Festmény a tárgyaló falán", type:"image", options:["https://picsum.photos/600/400?random=12","https://picsum.photos/600/400?random=13","https://picsum.photos/600/400?random=14"], archetypes:["Ceres","Juno","Venus"] },
  { q:"Női dresszkód", type:"image", options:["https://picsum.photos/600/400?random=15","https://picsum.photos/600/400?random=16","https://picsum.photos/600/400?random=17"], archetypes:["Mars","Jupiter","Apollo"] },
  { q:"Férfi dresszkód", type:"image", options:["https://picsum.photos/600/400?random=18","https://picsum.photos/600/400?random=19","https://picsum.photos/600/400?random=20"], archetypes:["Ceres","Juno","Venus"] },
  { q:"“1. TÁRGYALÓ”-felirat", type:"image", options:["https://picsum.photos/600/400?random=21","https://picsum.photos/600/400?random=22"], archetypes:["Mars","Jupiter"] },
  { q:"Képernyőkímélő diavetítés", type:"image", options:["https://picsum.photos/600/400?random=23","https://picsum.photos/600/400?random=24"], archetypes:["Apollo","Ceres"] },
  { q:"A cég személyiségéhez leginkább illő színek", type:"image", options:["https://picsum.photos/600/400?random=25","https://picsum.photos/600/400?random=26"], archetypes:["Juno","Venus"] },
  { q:"Csak a képzelet szab nekünk határt", type:"text", options:["Ez a jó irány, és mi meg is valósítjuk.","A tudás hatalom","A kompromisszumkészség erény, nem gyengeség","Egyedül kicsik vagyunk, együtt nagyot alkotunk","A világ a mi játszóterünk","A változásokból rugalmasan és optimistán kihozzuk a legjobbat."], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Venus"] },
  { q:"Mi a legnagyobb erénye a cégnek?", type:"text", options:["A bátorság az újításhoz, erő a megvalósításhoz.","Az ambíció, a nem-megalkuvás, mely a siker alapja.","A precíz tervezés, tiszta folyamatok, a munkatársak tudása.","A felelős hozzáállás, mely túlmutat a cég keretein.","Az eltérő nézőpontok elfogadása, képesség az együttműködésre.","A változásokból rugalmasan és optimistán kihozzuk a legjobbat."], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Venus"] },
  { q:"Mit élne meg a leginkább kudarcként a vezetőség?", type:"text", options:["szakmailag nem elég előremutató, ami innen kikerül","a versenytársak megelőznek minket","nem elég átlátható a cégstratégia és a működés","a sok bizonytalanság negatívan hat az emberekre és a munkára","nincsenek eléggé emberileg támogatva, nincs közösség","unalmasak, nem elég motiválóak a feladatok"], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Hera"] },
  { q:"Öt év múlva miből fogjátok látni, hogy jó úton jártok?", type:"text", options:["olyan innovációkat sikerült megvalósítanunk, mely egyedülálló az iparágunkban és sok újítás van még a tarsolyunkban","több területen sikerült domináns piaci szereplővé válni, cégünk a kategória megkerülhetetlen tényezőjévé vált","mindenki tudja a dolgát, mindennek megvan a gazdája, a szervezet flottul működik és ezáltal jobban tudunk építeni az embereink szakértelmére","kellemes a munkakörnyezet, nincs konfliktus, széthúzás, versengés csak nyugodt, egymásra odafigyelő és előremutató párbeszéd","összekovácsoltunk egy jó csapatot (kicsi a fluktuáció, könnyű embert találni), jó a házon belüli és az ügyfelekkel való együttműködés","az emberek élvezik a munkájukat, örömüket lelik abban, hogy itt dolgoznak nem csupán a társaság miatt, hanem mert itt nyitottak az ötleteikre"], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Venus"] },
  { q:"Milyen az ideális munkatárs?", type:"text", options:["Aki proaktív, elébe megy a dolgoknak, ezáltal a változások motorja","Aki karizmatikus, kezébe veszi még a nehéz feladatokat és meg is valósítja őket","Aki precíz, fegyelmezett, fókuszált és pontosan tudod, miben számíthatsz rá","Aki képes arra, hogy a különböző álláspontokat közös nevezőre hozza","Aki igazi csapatjátékos és a legtöbbet tudja kihozni másokból","Aki mindig optimistán áll a dolgokhoz, tele van jó ötletekkel"], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Venus"] },
  { q:"Mi a cég sikerstratégiája?", type:"text", options:["a státus qou megkérdőjelezése","a vízió és a hatékony vezetés","az elemzésen alapuló tervezés","a biztos alapok lefektetése","a különböző igények kielégítése","a lehetőségek kiaknázása"], archetypes:["Mars","Jupiter","Apollo","Ceres","Juno","Venus"] },
];

stepsData.forEach((s, i) => {
  let optionsHtml = s.options.map((opt, idx) => {
    if(s.type==="image"){
      return `<div class="option" data-archetype="${s.archetypes[idx]}"><img src="${opt}"></div>`;
    } else {
      return `<div class="option" data-archetype="${s.archetypes[idx]}">${opt}</div>`;
    }
  }).join("");
  stepsEl.innerHTML += `
    <div class="step">
      <h2>${i+1}. ${s.q}</h2>
      <div class="options">${optionsHtml}</div>
      <button onclick="nextStep()">Tovább</button>
    </div>
  `;
});

// végső step – csak eredmény, nincs új név/email, külön státusz szöveggel
stepsEl.innerHTML += `
<div class="step">
  <h2>Eredményed</h2>
  <div class="result" id="result"></div>
  <button id="sendBtn" onclick="sendResults()">Eredmény mentése</button>
  <div class="send-status" id="sendStatus"></div>
</div>
`;

let current = 0;
const steps = document.querySelectorAll(".step");

// start quiz
function startQuiz(){
  const email = document.getElementById("startEmail").value.trim();
  const name = document.getElementById("startName").value.trim();
  if(!email || !name) { 
    alert("Kérlek add meg az email címed és neved!"); 
    return; 
  }
  steps[0].classList.remove("active");
  current++;
  steps[current].classList.add("active");
}

// kiválasztás
document.addEventListener("click", e=>{
  const option = e.target.closest(".option");
  if(!option) return;
  option.parentElement.querySelectorAll(".option").forEach(o=>o.classList.remove("selected"));
  option.classList.add("selected");
});

// lépés váltás – utolsó kérdés gombja visz az eredmény stepre, ott már küldünk
function nextStep(){
  const selected = steps[current].querySelector(".option.selected");
  if(!selected) { 
    alert("Válassz egy opciót!"); 
    return; 
  }
  archetypes[selected.dataset.archetype]++;
  steps[current].classList.remove("active");
  current++;
  if(current===steps.length-1) showResult();
  steps[current].classList.add("active");
  window.scrollTo({top:0, behavior:"smooth"});
}

// eredmény megjelenítés
function showResult(){
  const total = Object.values(archetypes).reduce((a,b)=>a+b,0);
  let html="<ul>";
  for(const [k,v] of Object.entries(archetypes)){
    html+=`<li><strong>${k}</strong><span>${Math.round(v/total*100)}%</span></li>`;
  }
  html+="</ul>";
  document.getElementById("result").innerHTML=html;
}

// mentés Google Sheet-be – Vercel proxyval, a START mezőkből, egyszeri kattintás + loading
let isSending = false;

function sendResults(){
  if (isSending) return; // több kattintás tiltása

  const email = document.getElementById("startEmail").value.trim();
  const name = document.getElementById("startName").value.trim();
  if(!email || !name){ 
    alert("Hiányzó név vagy email. Lépj vissza az elejére és töltsd ki."); 
    return; 
  }

  const btn = document.getElementById("sendBtn");
  const statusEl = document.getElementById("sendStatus");

  isSending = true;
  btn.disabled = true;
  btn.textContent = "Küldés folyamatban...";
  statusEl.innerHTML = '<span class="spinner"></span>Eredmények mentése...';

  fetch("https://brand-quiz-proxy.vercel.app/api/quiz-proxy", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ email: email, name: name, results: archetypes })
  })
  .then(res => res.text())
  .then(text => {
    console.log("Válasz a szervertől:", text);
    statusEl.textContent = "Az eredményeket elmentettük. Köszönjük a kitöltést!";
    btn.textContent = "Elküldve";
  })
  .catch(err => {
    console.error(err);
    statusEl.textContent = "Hiba történt a mentés során. Kérjük, próbáld meg később újra.";
    btn.disabled = false;
    btn.textContent = "Eredmény mentése";
    isSending = false;
  });
}
</script>
</body>
</html>
